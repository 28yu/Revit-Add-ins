# Tools28 - 機能設計ドキュメント

このディレクトリには、新機能の設計書を保管します。

---

## 📁 ディレクトリ構成

```
Docs/
├── README.md                     # このファイル
├── Features/                     # 機能設計書の保管場所
│   ├── WallHeight-Example.md     # サンプル設計書
│   └── [YourFeature].md          # 新機能の設計書
└── .github/
    └── FEATURE_TEMPLATE.md       # 設計書テンプレート
```

---

## 🚀 新機能設計の流れ

### ステップ1: テンプレートをコピー

```bash
# 1. テンプレートをコピー
cp .github/FEATURE_TEMPLATE.md Docs/Features/YourFeature.md

# 2. エディタで開いて編集
# Visual Studio Code, Vim, など任意のエディタで編集
```

### ステップ2: 設計書を記入

以下のセクションを順番に埋めていきます：

#### 📋 基本情報
- 機能名（日本語・英語）
- クラス名
- 優先度
- 概要・目的

#### 🎨 UI設計
- リボンパネル配置
- ボタン名・ツールチップ
- アイコンの必要性
- ダイアログの有無

#### 🔧 技術仕様
- 対象ビュー・要素
- トランザクションモード
- 使用するRevit API

#### 📝 機能詳細
- 処理フロー
- 入力/出力
- エラーハンドリング

#### 🧪 テスト計画
- テストケース
- 想定される問題点

### ステップ3: レビュー・承認

設計書を完成させたら：
1. 内容を見直し
2. 必要に応じてチーム/クライアントに共有
3. フィードバックを反映

### ステップ4: 実装開始

設計が承認されたら、`DEVELOPMENT.md` の手順に従って実装を開始：

```powershell
# 1. Commands/配下にフォルダ作成
# 2. コマンドクラスを作成
# 3. Application.csにボタンを登録
# 4. QuickBuild.ps1でビルド＆テスト
```

---

## 📖 サンプル設計書

`Features/WallHeight-Example.md` に完成したサンプルがあります。
これを参考にして、自分の機能設計書を作成してください。

### サンプルのポイント

1. **具体的な数値**: 高さ「3000mm」など具体的に記載
2. **明確な処理フロー**: ステップを番号付きで記載
3. **詳細なテストケース**: 想定される全てのケースを列挙
4. **想定問題**: 実装前に問題点を洗い出し

---

## 💡 設計のヒント

### UI設計

- **リボンパネル**: 既存パネル（編集/表示/ビュー/シート）のどこに配置するか
- **ボタン名**: 短く、機能が明確に分かる名前（最大10文字程度）
- **ツールチップ**: 1文で機能を説明（20-30文字）
- **アイコン**: 機能を視覚的に表現（32x32 PNG）

### 技術仕様

- **対象要素**: Wall, Floor, Grid, Level など具体的に
- **トランザクション**: 基本的に`Manual`を推奨
- **API選択**: 既存コマンドで似た処理があれば参考に

### 処理フロー

- **ユーザー視点**: ボタンクリック → 何が起こる？
- **エラー処理**: 各ステップで何が失敗しうるか
- **フィードバック**: 結果をどうユーザーに伝えるか

### テスト計画

- **正常系**: 期待通りに動作するケース
- **異常系**: エラーが発生するケース
- **境界値**: 0, 負の数, 巨大な数値など
- **特殊ケース**: リンクファイル, グループ, カーテンウォールなど

---

## 📚 参考資料

### 既存コマンド

参考にできる既存のコマンド：

| コマンド | 参考になる点 |
|---------|-------------|
| `GridBubble` | パラメータの変更処理 |
| `SheetCreation` | WPFダイアログの実装 |
| `ViewCopy` | 3Dビューの操作 |
| `SectionBoxCopy` | トランザクション制御 |
| `ViewportPosition` | 複雑な処理フロー |
| `CropBoxCopy` | エラーハンドリング |

### Revit APIドキュメント

- **公式ドキュメント**: https://www.revitapidocs.com/
- **開発者ガイド**: https://www.autodesk.com/developer-network/platform-technologies/revit
- **フォーラム**: https://forums.autodesk.com/t5/revit-api-forum/bd-p/160

---

## ✅ チェックリスト

設計書を提出する前に、以下を確認してください：

### 必須項目

- [ ] 機能名（日本語・英語）を記入
- [ ] クラス名を決定（英語、PascalCase）
- [ ] 概要を2-3文で説明
- [ ] リボンパネル・ボタン名を決定
- [ ] 対象要素を明記
- [ ] 処理フローを記載
- [ ] テストケースを最低5個記載

### 推奨項目

- [ ] アイコンデザイン案を記載
- [ ] 使用するRevit APIをリストアップ
- [ ] エラーハンドリング方針を記載
- [ ] 想定される問題点を記載
- [ ] 参考にする既存コードを記載

### 品質確認

- [ ] 誤字脱字がない
- [ ] 専門用語が正しい
- [ ] 処理フローに矛盾がない
- [ ] テストケースが網羅的

---

## 🤝 サポート

設計書の作成で困ったことがあれば：

1. `WallHeight-Example.md` のサンプルを確認
2. `DEVELOPMENT.md` で実装手順を確認
3. `CLAUDE.md` でプロジェクト全体を確認
4. GitHubのIssuesで質問

---

## 📝 テンプレート更新履歴

| 日付 | 変更内容 |
|------|---------|
| 2024-02-05 | 初版作成 |
